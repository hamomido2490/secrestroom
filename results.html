<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„ | ØºØ±ÙØ© Ø§Ù„Ø£Ø³Ø±Ø§Ø±</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Tajawal', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      direction: rtl;
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }

    .site-title {
      color: #333;
      text-align: center;
      margin-bottom: 10px;
      font-size: 28px;
    }

    .result-title {
      color: #009688;
      text-align: center;
      margin-bottom: 30px;
      font-size: 24px;
    }

    #user-info {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      text-align: center;
    }

    #user-info p {
      margin: 5px 0;
      font-size: 18px;
    }

    .summary-box {
      background: linear-gradient(45deg, #009688, #4caf50);
      color: white;
      padding: 25px;
      border-radius: 10px;
      margin-bottom: 30px;
      text-align: center;
    }

    .summary-box h3 {
      margin-bottom: 15px;
      font-size: 22px;
    }

    .summary-box p {
      font-size: 18px;
      line-height: 1.6;
    }

    .analysis-section {
      margin-bottom: 30px;
    }

    .analysis-section h3 {
      color: #333;
      text-align: center;
      margin-bottom: 20px;
      font-size: 22px;
    }

    .theory-block {
      background: #f8f9fa;
      margin: 15px 0;
      padding: 20px;
      border-radius: 10px;
      border-right: 4px solid #009688;
    }

    .theory-block h4 {
      color: #009688;
      margin-bottom: 10px;
      font-size: 18px;
    }

    .theory-block p {
      color: #555;
      line-height: 1.6;
      font-size: 16px;
    }

    button {
      display: block;
      width: 100%;
      padding: 15px;
      margin: 10px 0;
      border: none;
      border-radius: 8px;
      font-family: 'Tajawal', sans-serif;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    button:nth-child(1) {
      background: #f44336;
      color: white;
    }

    button:nth-child(2) {
      background: #2196f3;
      color: white;
    }

    button:nth-child(3) {
      background: #9e9e9e;
      color: white;
    }

    footer {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #eee;
      color: #666;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }
      
      .site-title {
        font-size: 24px;
      }
      
      .result-title {
        font-size: 20px;
      }
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <h1 class="site-title">ØºØ±ÙØ© Ø§Ù„Ø£Ø³Ø±Ø§Ø± | Secrets Room</h1>
    <h2 class="result-title">Ù†ØªÙŠØ¬ØªÙƒ Ø§Ù„Ù†ÙØ³ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</h2>

    <div id="user-info"></div>

    <div id="summary" class="summary-box"></div>

    <div id="detailed-analysis" class="analysis-section"></div>

    <button onclick="downloadPDF()">ğŸ“„ ØªØ­Ù…ÙŠÙ„ ØªÙ‚Ø±ÙŠØ± PDF</button>
    <button onclick="copySummary()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®ØªØµØ±</button>
    <button onclick="window.location.href='index.html'">ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>

    <footer>
      <p>Â© 2025 Mohammed Tarek - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
    </footer>
  </div>

  <script>
    // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† localStorage
    const psychologyAnalysis = JSON.parse(localStorage.getItem('psychologyAnalysis'));
    
    if (!psychologyAnalysis) {
      window.location.href = 'index.html';
    }

    // 1. Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    document.getElementById('user-info').innerHTML = `
      <p><strong>Ø§Ù„Ø¹Ù…Ø±:</strong> ${psychologyAnalysis.demographic.age}</p>
      <p><strong>Ø§Ù„Ø¬Ù†Ø³:</strong> ${psychologyAnalysis.demographic.gender}</p>
    `;

    // 2. ØªÙˆÙ„ÙŠØ¯ ØªØ­Ù„ÙŠÙ„ Ù…Ø®ØªØµØ± Ù…Ø­Ø³Ù‘Ù†
    function generateSummary() {
      const categories = psychologyAnalysis.analysis;
      let traits = [];
      
      // ØªØ­Ù„ÙŠÙ„ Ù…Ø¨Ø³Ø· Ù„Ù„Ø³Ù…Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
      const freudScore = categories.freud ? 
        categories.freud.filter(a => a.answer.includes('Ù…ÙˆØ§ÙÙ‚')).length / categories.freud.length * 100 : 0;
      
      const adlerScore = categories.adler ? 
        categories.adler.filter(a => a.answer.includes('Ù…ÙˆØ§ÙÙ‚')).length / categories.adler.length * 100 : 0;
      
      const jungScore = categories.jung ? 
        categories.jung.filter(a => a.answer.includes('Ù…ÙˆØ§ÙÙ‚')).length / categories.jung.length * 100 : 0;

      if (freudScore > 60) traits.push('Ø¹Ù…ÙŠÙ‚Ø© ÙˆØ±Ù…Ø²ÙŠØ©');
      if (adlerScore > 60) traits.push('ambitious ÙˆØ·Ù…ÙˆØ­Ø©');
      if (jungScore > 60) traits.push('Ø±ÙˆØ­Ø§Ù†ÙŠØ© ÙˆÙ…ØªØµÙ„Ø© Ø¨Ø§Ù„Ù„Ø§ÙˆØ§Ø¹ÙŠ');

      if (traits.length === 0) traits.push('Ù…ØªÙˆØ§Ø²Ù†Ø© ÙˆÙ…Ø±Ù†Ø©');

      return `Ø£Ù†Øª Ø´Ø®ØµÙŠØ© ${traits.join('ØŒ ')} Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ Ø§Ù„Ø´Ø§Ù…Ù„Ø©.`;
    }

    const summaryText = generateSummary();
    document.getElementById('summary').innerHTML = `
      <h3>ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®ØªØµØ±</h3>
      <p>${summaryText}</p>
    `;

    // 3. ØªÙˆÙ„ÙŠØ¯ ØªØ­Ù„ÙŠÙ„ ØªÙØµÙŠÙ„ÙŠ Ù…Ø­Ø³Ù‘Ù†
    function generateDetailedAnalysis() {
      const categories = psychologyAnalysis.analysis;
      const analysis = {};

      // ØªØ­Ù„ÙŠÙ„ ÙØ±ÙˆÙŠØ¯
      if (categories.freud) {
        const score = categories.freud.filter(a => a.answer.includes('Ù…ÙˆØ§ÙÙ‚')).length / categories.freud.length * 100;
        analysis['Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ (ÙØ±ÙˆÙŠØ¯)'] = 
          score > 70 ? 'ØªØ´ÙŠØ± Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ Ø¥Ù„Ù‰ ØªØ£Ø«ÙŠØ± Ù‚ÙˆÙŠ Ù„Ù„Ù„Ø§ÙˆØ¹ÙŠ Ø¹Ù„Ù‰ Ø³Ù„ÙˆÙƒÙƒØŒ Ù…Ø¹ ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù…ÙˆØ² ÙˆØ§Ù„Ø£Ø­Ù„Ø§Ù… ÙƒÙˆØ³ÙŠÙ„Ø© Ù„ÙÙ‡Ù… Ø§Ù„Ø°Ø§Øª.' :
          score > 40 ? 'ØªØ¸Ù‡Ø± Ù„Ø¯ÙŠÙƒ ÙˆØ¹ÙŠ Ù…ØªÙˆØ³Ø· Ø¨Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù„Ø§ÙˆØ§Ø¹ÙŠØ©ØŒ Ù…Ø¹ ÙÙ‡Ù… Ø¬ÙŠØ¯ Ù„Ù„Ø¢Ù„ÙŠØ§Øª Ø§Ù„Ø¯ÙØ§Ø¹ÙŠØ©.' :
          'Ù„Ø¯ÙŠÙƒ ÙˆØ¹ÙŠ Ø¹Ø§Ù„ÙŠ Ø¨Ø§Ù„Ø¹Ù‚Ù„ Ø§Ù„ÙˆØ§Ø¹ÙŠØŒ Ù…Ø¹ ØªØ±ÙƒÙŠØ² Ø£Ù‚Ù„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ù…Ø²ÙŠ Ù„Ù„Ø³Ù„ÙˆÙƒ.';
      }

      // ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ù„Ø±
      if (categories.adler) {
        const score = categories.adler.filter(a => a.answer.includes('Ù…ÙˆØ§ÙÙ‚')).length / categories.adler.length * 100;
        analysis['Ø¹Ù„Ù… Ø§Ù„Ù†ÙØ³ Ø§Ù„ÙØ±Ø¯ÙŠ (Ø£Ø¯Ù„Ø±)'] = 
          score > 70 ? 'ØªØ´ÙŠØ± Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ Ø¥Ù„Ù‰ Ø³Ø¹ÙŠ Ù‚ÙˆÙŠ Ù„Ù„ØªÙÙˆÙ‚ ÙˆØ§Ù„ØªÙ…ÙŠØ²ØŒ Ù…Ø¹ ÙˆØ¹ÙŠ Ø¨Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ù„ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ.' :
          score > 40 ? 'ØªØ¸Ù‡Ø± Ù„Ø¯ÙŠÙƒ Ø¯ÙˆØ§ÙØ¹ Ù…ØªÙˆØ³Ø·Ø© Ù„Ù„ØªÙÙˆÙ‚ØŒ Ù…Ø¹ ØªÙˆØ§Ø²Ù† Ø¨ÙŠÙ† Ø§Ù„Ø°Ø§Øª ÙˆØ§Ù„Ù…Ø¬ØªÙ…Ø¹.' :
          'ØªÙØ¶Ù„ Ø§Ù„Ø§Ø³ØªÙ‚Ø±Ø§Ø± ÙˆØ§Ù„Ø±Ø§Ø­Ø©ØŒ Ù…Ø¹ ØªØ±ÙƒÙŠØ² Ø£Ù‚Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© ÙˆØ§Ù„ØªÙÙˆÙ‚.';
      }

      // ØªØ­Ù„ÙŠÙ„ ÙŠÙˆÙ†Øº
      if (categories.jung) {
        const score = categories.jung.filter(a => a.answer.includes('Ù…ÙˆØ§ÙÙ‚')).length / categories.jung.length * 100;
        analysis['Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ÙŠ (ÙŠÙˆÙ†Øº)'] = 
          score > 70 ? 'ØªØ¸Ù‡Ø± Ù„Ø¯ÙŠÙƒ Ø§ØªØµØ§Ù„ Ù‚ÙˆÙŠ Ø¨Ø§Ù„Ù„Ø§ÙˆØ¹ÙŠ Ø§Ù„Ø¬Ù…Ø¹ÙŠØŒ Ù…Ø¹ ÙˆØ¹ÙŠ Ø¨Ø§Ù„Ø£Ø±ÙƒÙŠØªØ§ÙŠØ¨Ø§Øª ÙˆØ§Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ø±ÙˆØ­ÙŠØ©.' :
          score > 40 ? 'Ù„Ø¯ÙŠÙƒ ÙˆØ¹ÙŠ Ù…ØªÙˆØ³Ø· Ø¨Ø§Ù„Ø¬ÙˆØ§Ù†Ø¨ Ø§Ù„Ø±ÙˆØ­ÙŠØ© ÙˆØ§Ù„Ø±Ù…Ø²ÙŠØ© ÙÙŠ Ø´Ø®ØµÙŠØªÙƒ.' :
          'ØªØ±ÙƒØ² Ø£ÙƒØ«Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ§Ù‚Ø¹ ÙˆØ§Ù„Ø¹Ù‚Ù„ Ø§Ù„ÙˆØ§Ø¹ÙŠØŒ Ù…Ø¹ Ø§Ù‡ØªÙ…Ø§Ù… Ø£Ù‚Ù„ Ø¨Ø§Ù„Ø¬ÙˆØ§Ù†Ø¨ Ø§Ù„Ø±ÙˆØ­ÙŠØ©.';
      }

      // ØªØ­Ù„ÙŠÙ„ MBTI
      if (categories.mbti) {
        const introversion = categories.mbti.filter(a => a.answer.includes('ØºÙŠØ± Ù…ÙˆØ§ÙÙ‚')).length;
        const extroversion = categories.mbti.filter(a => a.answer.includes('Ù…ÙˆØ§ÙÙ‚')).length;
        analysis['MBTI - Ù…Ø¤Ø´Ø± Ù…Ø§ÙŠØ±Ø² Ø¨Ø±ÙŠØºØ²'] = 
          introversion > extroversion ? 'ØªØ´ÙŠØ± Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ Ø¥Ù„Ù‰ Ù†Ù…Ø· Ø´Ø®ØµÙŠØ© Ù…Ù† introvertØŒ ØªÙØ¶Ù„ Ø§Ù„ÙˆØ­Ø¯Ø© ÙˆØ§Ù„ØªØ£Ù…Ù„ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ.' :
          extroversion > introversion ? 'ØªØ´ÙŠØ± Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ Ø¥Ù„Ù‰ Ù†Ù…Ø· Ø´Ø®ØµÙŠØ© Ù…Ù† extrovertØŒ ØªÙØ¶Ù„ Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ ÙˆØ§Ù„Ù†Ø´Ø§Ø·.' :
          'ØªØ¸Ù‡Ø± Ù„Ø¯ÙŠÙƒ ØªÙˆØ§Ø²Ù† Ø¬ÙŠØ¯ Ø¨ÙŠÙ† Ø§Ù„Ø§Ù†Ø¹Ø²Ø§Ù„ ÙˆØ§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ.';
      }

      // ØªØ­Ù„ÙŠÙ„ Big Five
      if (categories.bigfive) {
        const openness = categories.bigfive.filter(a => a.answer.includes('Ù…ÙˆØ§ÙÙ‚')).length / categories.bigfive.length * 100;
        analysis['Big Five - Ø§Ù„Ø³Ù…Ø§Øª Ø§Ù„Ø®Ù…Ø³ Ø§Ù„ÙƒØ¨Ø±Ù‰'] = 
          openness > 70 ? 'Ø¯Ø±Ø¬Ø§ØªÙƒ Ø§Ù„Ù…Ø±ØªÙØ¹Ø© ÙÙŠ Ø§Ù„Ø§Ù†ÙØªØ§Ø­ ØªØ´ÙŠØ± Ø¥Ù„Ù‰ Ø´Ø®ØµÙŠØ© Ù…Ø¨Ø¯Ø¹Ø© ÙˆÙ…Ø­Ø¨Ø© Ù„Ù„Ù…ØºØ§Ù…Ø±Ø© ÙˆØ§Ù„ØªØ¬Ø§Ø±Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©.' :
          openness > 40 ? 'ØªØ¸Ù‡Ø± Ù„Ø¯ÙŠÙƒ ØªÙˆØ§Ø²Ù† Ø¬ÙŠØ¯ Ø¨ÙŠÙ† Ø§Ù„Ø§Ø³ØªÙ‚Ø±Ø§Ø± ÙˆØ§Ù„Ù…ØºØ§Ù…Ø±Ø© ÙÙŠ ØªØ¬Ø§Ø±Ø¨Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©.' :
          'ØªÙØ¶Ù„ Ø§Ù„Ø§Ø³ØªÙ‚Ø±Ø§Ø± ÙˆØ§Ù„Ø±ÙˆØªÙŠÙ†ØŒ Ù…Ø¹ ØªØ±ÙƒÙŠØ² Ø£Ù‚Ù„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¬Ø§Ø±Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©.';
      }

      // ØªØ­Ù„ÙŠÙ„ TA
      if (categories.ta) {
        const adult = categories.ta.filter(a => a.answer.includes('Ù…ÙˆØ§ÙÙ‚')).length / categories.ta.length * 100;
        analysis['ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª (TA)'] = 
          adult > 70 ? 'ØªØ´ÙŠØ± Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ Ø¥Ù„Ù‰ Ø³ÙŠØ·Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ø§Ù„ØºØ©ØŒ Ù…Ø¹ Ø§ØªØ®Ø§Ø° Ù‚Ø±Ø§Ø±Ø§Øª Ù…Ù†Ø·Ù‚ÙŠØ© ÙˆÙ…ØªÙˆØ§Ø²Ù†Ø©.' :
          adult > 40 ? 'ØªØ¸Ù‡Ø± Ù„Ø¯ÙŠÙƒ ØªÙˆØ§Ø²Ù† Ø¬ÙŠØ¯ Ø¨ÙŠÙ† Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ø§Ù„ØºØ© ÙˆØ§Ù„Ø·ÙÙ„ÙŠØ© ÙÙŠ ØªØ¹Ø§Ù…Ù„Ùƒ Ù…Ø¹ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†.' :
          'Ù‚Ø¯ ØªØªØ£Ø«Ø± Ø£Ø­ÙŠØ§Ù†Ø§Ù‹ Ø¨Ø§Ù„Ù…Ø´Ø§Ø¹Ø± ÙˆØ§Ù„Ø§Ù†ÙØ¹Ø§Ù„Ø§Øª ÙÙŠ ØªØ¹Ø§Ù…Ù„Ùƒ Ù…Ø¹ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†.';
      }

      return analysis;
    }

    const detailedAnalysis = generateDetailedAnalysis();
    let detailHTML = '<h3>ğŸ” Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ù†Ø¸Ø±ÙŠØ§Øª</h3>';
    
    for (const [theory, content] of Object.entries(detailedAnalysis)) {
      if (content) { // Ø¹Ø±Ø¶ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ØªØ­Ù„ÙŠÙ„
        detailHTML += `<div class='theory-block'><h4>${theory}</h4><p>${content}</p></div>`;
      }
    }
    
    document.getElementById('detailed-analysis').innerHTML = detailHTML;

    // 4. ØªÙˆÙ„ÙŠØ¯ ØªÙ‚Ø±ÙŠØ± PDF Ù…Ø­Ø³Ù‘Ù†
    function downloadPDF() {
      try {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ø±Ø¨ÙŠ
        doc.setFont("helvetica");
        
        // Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
        doc.setFontSize(16);
        doc.setTextColor(0, 0, 0);
        doc.text("Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ÙØ³ÙŠ - ØºØ±ÙØ© Ø§Ù„Ø£Ø³Ø±Ø§Ø±", 105, 20, null, null, 'center');
        
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        doc.setFontSize(12);
        doc.text(`Ø§Ù„Ø¹Ù…Ø±: ${psychologyAnalysis.demographic.age}`, 20, 35);
        doc.text(`Ø§Ù„Ø¬Ù†Ø³: ${psychologyAnalysis.demographic.gender}`, 150, 35);
        
        // Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®ØªØµØ±
        doc.setFontSize(14);
        doc.setTextColor(0, 100, 0);
        doc.text("Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®ØªØµØ±:", 20, 50);
        doc.setFontSize(10);
        doc.setTextColor(0, 0, 0);
        doc.text(summaryText, 20, 60, { maxWidth: 170 });
        
        // Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ
        let y = 80;
        doc.setFontSize(14);
        doc.setTextColor(0, 0, 255);
        doc.text("Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ:", 20, y);
        y += 10;
        
        doc.setFontSize(10);
        doc.setTextColor(0, 0, 0);
        
        Object.entries(detailedAnalysis).forEach(([theory, content], index) => {
          if (content && y < 270) { // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ØªØ¬Ø§ÙˆØ² Ø­Ø¬Ù… Ø§Ù„ØµÙØ­Ø©
            doc.setFontSize(12);
            doc.setTextColor(100, 0, 0);
            doc.text(theory + ":", 20, y);
            y += 8;
            
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            const lines = doc.splitTextToSize(content, 170);
            doc.text(lines, 20, y);
            y += lines.length * 7 + 5;
          }
        });
        
        // Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª
        const date = new Date().toLocaleDateString('ar-SA');
        doc.setFontSize(8);
        doc.setTextColor(128, 128, 128);
        doc.text(`ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ù„ÙŠÙ„: ${date}`, 20, 280);
        doc.text("Â© 2025 Mohammed Tarek", 150, 280);
        
        doc.save("ØªØ­Ù„ÙŠÙ„_Ù†ÙØ³ÙŠ_Ù…ØªÙƒØ§Ù…Ù„.pdf");
      } catch (error) {
        console.error('Error generating PDF:', error);
        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
      }
    }

    // 5. Ù†Ø³Ø® Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®ØªØµØ±
    function copySummary() {
      navigator.clipboard.writeText(summaryText).then(() => {
        alert("âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®ØªØµØ± Ø¨Ù†Ø¬Ø§Ø­!");
      }).catch(err => {
        console.error('Failed to copy: ', err);
        // Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… prompt
        const textArea = document.createElement('textarea');
        textArea.value = summaryText;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        alert("âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®ØªØµØ± Ø¨Ù†Ø¬Ø§Ø­!");
      });
    }
  </script>
</body>
</html>
