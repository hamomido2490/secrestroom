<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ØºØ±ÙØ© Ø§Ù„Ø£Ø³Ø±Ø§Ø±</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <!-- Ù‡ÙŠØ¯Ø± ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· -->
  <header>
    <div class="site-title">ØºØ±ÙØ© Ø§Ù„Ø£Ø³Ø±Ø§Ø±  
<span style="font-size: 1.2rem; font-weight: normal;">Secrets Room</span></div>
    <div>
      <p id="welcome" style="font-style:italic; margin: 0;"></p>
      <div style="display: flex; gap: 10px; align-items: center; justify-content: center;">
        <button id="themeToggle" onclick="toggleTheme( )" style="padding: 8px 12px; font-size: 1.2rem;">ğŸŒ“</button>
        <select id="langSelect" onchange="changeLanguage(this.value)" style="margin: 0;">
          <option value="ar">ğŸ‡ªğŸ‡¬ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
          <option value="en">ğŸ‡ºğŸ‡¸ English</option>
          <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
          <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
          <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
          <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
        </select>
        <button id="logoutBtn" onclick="logout()" style="display:none; padding: 8px 12px;">ğŸ”’</button>
      </div>
    </div>
  </header>

  <div id="content">
    <!-- 1. Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
    <section id="welcomeSection" class="active">
      <label id="ageLabel" for="ageInput"></label>
      <input type="number" id="ageInput" min="10" max="100">
      <label id="genderLabel" for="genderSelect"></label>
      <select id="genderSelect">
        <option value="male"> Ø°ÙƒØ±â™‚ï¸</option>
        <option value="female">Ø§Ù†Ø«ÙŠâ™€ï¸</option>
        <option value="other">Ù„Ø§ Ø§Ø±ÙŠØ¯ Ø§Ù„ØªØ­Ø¯ÙŠØ¯âš§ï¸</option>
      </select>
      <button id="startBtn" onclick="startTest()"></button>
    </section>

    <!-- 2. Ø§Ù„Ø£Ø³Ø¦Ù„Ø© -->
    <section id="quizSection">
      <div class="progress-container">
        <div class="progress-bar">
          <div id="progressFill"></div>
        </div>
        <span id="progressText"></span>
      </div>
      <div id="questionContainer"></div>
      <div id="answerOptions"></div>
      <button id="nextBtn" onclick="nextQuestion()" disabled></button>
    </section>

    <!-- 3. Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
    <section id="resultSection">
      <div id="resultNavigation" class="actions" style="text-align: center; margin-bottom: 20px;">
        <button id="btnPersonalityType" onclick="displayResultContent('personalityType')">ØªØµÙ†ÙŠÙ Ø§Ù„Ø´Ø®ØµÙŠØ©</button>
        <button id="btnSummary" onclick="displayResultContent('summary')">Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®ØªØµØ±</button>
        <button id="btnTheories" onclick="displayResultContent('theories')">Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø­Ø³Ø¨ Ø§Ù„Ù†Ø¸Ø±ÙŠØ§Øª</button>
        <button id="btnDetailedAnalysis" onclick="displayResultContent('detailedAnalysis')">Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</button>
        <button id="btnRecommendations" onclick="displayResultContent('recommendations')">Ø§Ù„ØªÙˆØµÙŠØ§Øª</button>
      </div>

      <div id="personalityTypeSection" class="result-section-content" style="display:none;">
        <div id="personalityTypeContent"></div>
      </div>
      <div id="summarySection" class="result-section-content" style="display:none;">
        <div id="summaryContent"></div>
      </div>
      <div id="theoriesSection" class="result-section-content" style="display:none;">
        <div id="theoriesContent"></div>
      </div>
      <div id="detailedAnalysisSection" class="result-section-content" style="display:none;">
        <div id="detailedAnalysisContent"></div>
      </div>
      <div id="recommendationsSection" class="result-section-content" style="display:none;">
        <div id="recommendationsContent"></div>
      </div>

      <div class="actions">
        <button id="downloadPdfBtn" onclick="downloadPDF()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± PDF</button>
        <button id="shareBtn" onclick="shareResult()">Ù…Ø´Ø§Ø±ÙƒØ©</button>
      </div>
    </section>

    <!-- 4. Ø¥Ø¹Ù„Ø§Ù† Ø±Ø¨Ø­ÙŠ -->
    <section id="adSection">
      <p style="text-align:center;">[ Ø¥Ø¹Ù„Ø§Ù† ]</p>
    </section>
  </div>

  <div id="theoryModal" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close" onclick="closeTheoryModal()">&times;</span>
      <div id="theoryModalContent"></div>
    </div>
  </div>

  <!-- ØªÙ… Ø­Ø°Ù lang.js Ù…Ù† Ù‡Ù†Ø§ -->
  <script src="questions.js"></script>
  <script src="analysis_data.js"></script>
  <script src="script.js"></script>

  <footer style="text-align: center; margin-top: 30px; padding: 15px; font-size: 0.9rem; color: #666; border-top: 1px solid #eee;">
    <p>&copy; 2025 Mohammed Tarek</p>
  </footer>
</body>
</html>```

---

### 2. Ù…Ù„Ù `script.js` (Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©)

**Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:**
*   ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ù„Ø© `loadLanguage` Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ù„ÙØ§Øª Ø§Ù„Ù„ØºØ§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ù…Ù† Ù…Ø¬Ù„Ø¯ `locales`.
*   ØªÙ… ØªØ¹Ø¯ÙŠÙ„ `initLanguage` Ùˆ `changeLanguage` Ùˆ `window.onload` Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯.
*   ÙŠØªÙ… Ø§Ù„Ø¢Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… `import()` Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØŒ ÙˆÙ‡ÙŠ Ù…ÙŠØ²Ø© Ø­Ø¯ÙŠØ«Ø© ÙˆÙØ¹Ø§Ù„Ø©.

```javascript
// script.js - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ù…Ø¹ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ØºØ§Øª Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ

// --- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ---
let translations = {}; // Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§
let currentLang = localStorage.getItem("lang") || "ar";
let deviceId = localStorage.getItem("deviceId") || "";
let userSession = JSON.parse(localStorage.getItem("session")) || null;
let currentQuestion = 0;
let answers = [];
let userAnswers = {};
let categoryAverages = {};
let domainAverages = {};

// --- Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ÙˆØ§Ù„Ù„ØºØ© ---

// Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§
async function loadLanguage(lang) {
  // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù…Ø­Ù…Ù„Ø© Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©ØŒ ÙÙ‚Ø· Ù‚Ù… Ø¨ØªØ·Ø¨ÙŠÙ‚Ù‡Ø§
  if (translations[lang]) {
    applyLanguage(lang);
    return;
  }
  
  try {
    // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù„Ù Ø§Ù„Ù„ØºØ© Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙŠØ²Ø© Ø­Ø¯ÙŠØ«Ø©
    // Ù…Ù„Ø§Ø­Ø¸Ø©: ÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØªÙˆÙŠ Ù…Ù„ÙØ§Øª Ø§Ù„Ù„ØºØ§Øª Ø¹Ù„Ù‰ "export default"
    const { default: langData } = await import(`./locales/${lang}.js`);
    translations[lang] = langData; // ØªØ®Ø²ÙŠÙ† Ø§Ù„ØªØ±Ø¬Ù…Ø© ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©
    applyLanguage(lang);
  } catch (error) {
    console.error(`ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ù„ØºØ© '${lang}'. Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙƒØ¨Ø¯ÙŠÙ„.`, error);
    // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ÙØ´Ù„ (Ù…Ø«Ù„ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ù„Ù)ØŒ Ø­Ø§ÙˆÙ„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙƒÙ„ØºØ© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
    if (lang !== 'en') {
      await loadLanguage('en');
    }
  }
}

function initDevice() {
  if (!deviceId) {
    deviceId = "SR-" + Math.random().toString(36).substr(2, 9);
    localStorage.setItem("deviceId", deviceId);
  }
}

function initLanguage() {
  const langToLoad = localStorage.getItem("lang") || "ar";
  currentLang = langToLoad;
  document.getElementById("langSelect").value = currentLang;
}

function applyLanguage(lang) {
  if (!translations[lang]) {
    console.error(`Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù„Ù„ØºØ© ${lang} ØºÙŠØ± Ù…ØªÙˆÙØ±Ø© ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©.`);
    return;
  }
  const t = translations[lang].ui;
  document.documentElement.lang = lang;
  document.documentElement.dir = lang === "ar" ? "rtl" : "ltr";
  
  document.title = t.title || "Secrets Room";

  const siteTitle = document.querySelector('.site-title');
  if (siteTitle) {
    if (lang === "ar") {
      siteTitle.innerHTML = 'ØºØ±ÙØ© Ø§Ù„Ø£Ø³Ø±Ø§Ø±  
<span style="font-size: 1.2rem; font-weight: normal;">Secrets Room</span>';
    } else {
      siteTitle.innerHTML = 'Secrets Room  
<span style="font-size: 1.2rem; font-weight: normal;">ØºØ±ÙØ© Ø§Ù„Ø£Ø³Ø±Ø§Ø±</span>';
    }
  }

  document.getElementById("ageLabel").innerText = t.age || "";
  document.getElementById("genderLabel").innerText = t.gender || "";
  document.getElementById("startBtn").innerText = t.start || "";
  document.getElementById("nextBtn").innerText = t.next || "";
  
  const welcomeElement = document.getElementById("welcome");
  const logoutBtnElement = document.getElementById("logoutBtn");
  if (welcomeElement) {
      if (userSession) {
        welcomeElement.innerText = t.welcome || "";
        if (logoutBtnElement) logoutBtnElement.style.display = "inline-block";
      } else {
        welcomeElement.innerText = "";
        if (logoutBtnElement) logoutBtnElement.style.display = "none";
      }
  }
  updateResultButtonTitles();
}

async function changeLanguage(lang) {
  localStorage.setItem("lang", lang);
  currentLang = lang;
  await loadLanguage(lang); // ØªØ­Ù…ÙŠÙ„ ÙˆØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  // Ø¥Ø¹Ø§Ø¯Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø£Ùˆ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  if (document.getElementById("quizSection").classList.contains("active")) {
    renderQuestion();
  } else if (document.getElementById("resultSection").classList.contains("active")) {
    // Ø¥Ø¹Ø§Ø¯Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù†Ø´Ø· Ù…Ù† Ø§Ù„Ù†ØªØ§Ø¦Ø¬
    const activeResultSection = document.querySelector('.result-section-content[style*="block"]');
    if (activeResultSection) {
        const sectionName = activeResultSection.id.replace('Section', '');
        displayResultContent(sectionName);
    }
  }
}

// --- Ø¯ÙˆØ§Ù„ Ø§Ù„Ø«ÙŠÙ… ÙˆØ§Ù„Ù…Ø¸Ù‡Ø± ---
function applyTheme(theme) {
  document.body.className = theme;
  localStorage.setItem("theme", theme);
}

function toggleTheme() {
  const next = (localStorage.getItem("theme") === "dark") ? "light" : "dark";
  applyTheme(next);
}

// --- Ø¯ÙˆØ§Ù„ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ---
function startTest() {
  const age = document.getElementById("ageInput").value;
  const gender = document.getElementById("genderSelect").value;
  if (!age) return alert(translations[currentLang]?.ui?.age || "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¹Ù…Ø±");
  userSession = { age, gender, deviceId, timestamp: Date.now() };
  localStorage.setItem("session", JSON.stringify(userSession));
  document.getElementById("welcomeSection").classList.remove("active");
  document.getElementById("quizSection").classList.add("active");
  renderQuestion();
}

function renderQuestion() {
  if (currentQuestion >= questions.length) return showResults();
  const q = questions[currentQuestion];
  const container = document.getElementById("questionContainer");
  const optionsContainer = document.getElementById("answerOptions");

  container.innerHTML = `<div class="question">${q.text[currentLang] || q.text['en']}</div>`;
  updateProgress();
  optionsContainer.innerHTML = '';

  if (q.scale === "1-5") {
    const scaleContainer = document.createElement('div');
    scaleContainer.className = 'scale-options';
    for (let i = 1; i <= 5; i++) {
      const option = document.createElement('div');
      option.className = 'scale-option';
      option.textContent = i;
      option.onclick = () => selectAnswer(i);
      scaleContainer.appendChild(option);
    }
    optionsContainer.appendChild(scaleContainer);
  } else {
    const likertOptions = translations[currentLang]?.options?.likert || {};
    Object.entries(likertOptions).forEach(([val, txt]) => {
      const option = document.createElement('div');
      option.className = 'answer-option';
      option.textContent = txt;
      option.onclick = () => selectAnswer(Number(val));
      optionsContainer.appendChild(option);
    });
  }
  document.getElementById('nextBtn').disabled = true;
}

function selectAnswer(value) {
  userAnswers[currentQuestion] = value;
  if (questions[currentQuestion].scale === "1-5") {
    document.querySelectorAll('.scale-option').forEach((opt, index) => {
      opt.classList.toggle('selected', index + 1 === value);
    });
  } else {
    const likertOptions = translations[currentLang]?.options?.likert || {};
    const optionValues = Object.keys(likertOptions);
    document.querySelectorAll('.answer-option').forEach((opt, index) => {
       opt.classList.toggle('selected', Number(optionValues[index]) === value);
    });
  }
  document.getElementById('nextBtn').disabled = false;
}

function updateProgress() {
  const progress = ((currentQuestion + 1) / questions.length) * 100;
  document.getElementById('progressFill').style.width = progress + '%';
  document.getElementById('progressText').textContent = `${currentQuestion + 1} / ${questions.length}`;
}

function nextQuestion() {
  if (!userAnswers.hasOwnProperty(currentQuestion)) return;
  answers.push({
    questionId: questions[currentQuestion].id,
    category: questions[currentQuestion].category,
    domain: questions[currentQuestion].domain,
    value: userAnswers[currentQuestion]
  });
  currentQuestion++;
  if (currentQuestion < questions.length) {
    renderQuestion();
  } else {
    showResults();
  }
}

// --- Ø¯ÙˆØ§Ù„ Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ---
function showResults() {
  document.getElementById("quizSection").classList.remove("active");
  document.getElementById("resultSection").classList.add("active");
  calculateAverages();
  updateResultButtonTitles();
  displayResultContent('personalityType');
}

function calculateAverages() {
  const categoryScores = {};
  answers.forEach(a => {
    if (!categoryScores[a.category]) categoryScores[a.category] = { total: 0, count: 0 };
    categoryScores[a.category].total += a.value;
    categoryScores[a.category].count += 1;
  });
  categoryAverages = {};
  for (const [cat, data] of Object.entries(categoryScores)) {
    categoryAverages[cat] = data.total / data.count;
  }

  const domainScores = {};
  answers.forEach(a => {
    if (!domainScores[a.domain]) domainScores[a.domain] = { total: 0, count: 0 };
    domainScores[a.domain].total += a.value;
    domainScores[a.domain].count += 1;
  });
  domainAverages = {};
  for (const [dom, data] of Object.entries(domainScores)) {
    domainAverages[dom] = data.total / data.count;
  }
}

function updateResultButtonTitles() {
  const t = translations[currentLang]?.ui || {};
  document.getElementById("btnPersonalityType").innerText = t.personality_type || "Personality Type";
  document.getElementById("btnSummary").innerText = t.summary_analysis || "Summary Analysis";
  document.getElementById("btnTheories").innerText = t.theories_analysis || "Theories Analysis";
  document.getElementById("btnDetailedAnalysis").innerText = t.detailed_analysis || "Detailed Analysis";
  document.getElementById("btnRecommendations").innerText = t.recommendations || "Recommendations";
  document.getElementById("downloadPdfBtn").innerText = t.download_pdf || "Download PDF";
  document.getElementById("shareBtn").innerText = t.share || "Share";
}

function displayResultContent(sectionName) {
    document.querySelectorAll('.result-section-content').forEach(section => {
        section.style.display = 'none';
    });
    const sectionId = `${sectionName}Section`;
    const sectionElement = document.getElementById(sectionId);
    if (sectionElement) {
        sectionElement.style.display = 'block';
    } else {
        return;
    }
    switch (sectionName) {
        case 'personalityType': displayPersonalityType(); break;
        case 'summary': displaySummaryAnalysis(); break;
        case 'theories': displayTheoriesAnalysis(); break;
        case 'detailedAnalysis': displayDetailedAnalysis(); break;
        case 'recommendations': displayRecommendations(); break;
    }
}

// --- Ø¯ÙˆØ§Ù„ ØªÙˆÙ„ÙŠØ¯ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ (ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ) ---
// ... (Ø¬Ù…ÙŠØ¹ Ø¯ÙˆØ§Ù„ display... Ùˆ get... ØªØ¨Ù‚Ù‰ Ù‡Ù†Ø§ Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±)
// Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø¯Ø§Ù„Ø© ÙˆØ§Ø­Ø¯Ø©ØŒ Ø§Ù„Ø¨Ù‚ÙŠØ© ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ ÙÙŠ Ù…Ù„ÙÙƒ Ø§Ù„Ø£ØµÙ„ÙŠ
function displayPersonalityType() {
    const contentDiv = document.getElementById("personalityTypeContent");
    const sortedDomains = Object.entries(domainAverages).sort((a, b) => b[1] - a[1]);
    const topDomainKey = sortedDomains[0]?.[0] || "vision";
    let personalityColor, colorDescription, themes = [];

    // Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ­Ù„ÙŠÙ„ÙŠØ© Ø®Ø§ØµØ© Ø¨ÙƒØŒ Ø³Ø£ØªØ±ÙƒÙ‡ ÙƒÙ…Ø§ Ù‡Ùˆ
    if (topDomainKey === "vision" || topDomainKey === "discovery") {
        personalityColor = "Ø´Ø®ØµÙŠØ© Ø­Ù…Ø±Ø§Ø¡";
        colorDescription = "Ø£Ù†Øª Ø´Ø®Øµ Ø­Ù…Ø§Ø³ÙŠØŒ Ù…Ù„ÙŠØ§Ù† Ø·Ø§Ù‚Ø©ØŒ ÙˆØ¨ØªØ³Ø¹Ù‰ Ù„Ù„Ù‚ÙŠØ§Ø¯Ø© ÙˆØ§Ù„Ø§Ø³ØªÙƒØ´Ø§Ù. Ø¨ØªØ­Ø¨ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª ÙˆØ§Ù„Ø§Ø¨ØªÙƒØ§Ø±.";
        themes = ["Ø§Ù„Ø·Ø§Ù‚Ø©", "Ø§Ù„Ø´ØºÙ", "Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©", "Ø§Ù„Ø§Ø¨ØªÙƒØ§Ø±", "Ø§Ù„Ø¬Ø±Ø£Ø©"];
    } else if (topDomainKey === "analysis" || topDomainKey === "healing") {
        personalityColor = "Ø´Ø®ØµÙŠØ© Ø²Ø±Ù‚Ø§Ø¡";
        colorDescription = "Ø£Ù†Øª Ø´Ø®Øµ Ù‡Ø§Ø¯Ø¦ØŒ ØªØ­Ù„ÙŠÙ„ÙŠØŒ ÙˆØ¨ØªÙØ¶Ù„ Ø§Ù„ØªØ£Ù…Ù„ ÙˆØ§Ù„ÙÙ‡Ù… Ø§Ù„Ø¹Ù…ÙŠÙ‚. Ø¨ØªØ­Ø¨ Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©.";
        themes = ["Ø§Ù„Ù‡Ø¯ÙˆØ¡", "Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ø¹Ù…ÙŠÙ‚", "Ø§Ù„ØªØ­Ù„ÙŠÙ„", "Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©", "Ø§Ù„ØªÙ†Ø¸ÙŠÙ…"];
    } else {
        personalityColor = "Ø´Ø®ØµÙŠØ© Ø¨Ù†ÙØ³Ø¬ÙŠØ©";
        colorDescription = "Ø£Ù†Øª Ø´Ø®Øµ Ù…Ø¹Ù‚Ø¯ ÙˆÙ…ØªÙ†ÙˆØ¹ØŒ Ø¨ØªÙ…Ø²Ø¬ Ø¨ÙŠÙ† Ø®ØµØ§Ø¦Øµ ÙƒØªÙŠØ±. Ø¨ØªØ­Ø¨ Ø§Ù„ØªÙ†ÙˆØ¹ ÙˆØ§Ù„ØªØ·ÙˆØ± Ø§Ù„Ù…Ø³ØªÙ…Ø±.";
        themes = ["Ø§Ù„ØªÙ†ÙˆØ¹", "Ø§Ù„ØªØ·ÙˆØ±", "Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹", "Ø§Ù„Ù…Ø±ÙˆÙ†Ø©", "Ø§Ù„Ø¹Ù…Ù‚"];
    }

    let html = `<h2>${personalityColor}</h2><p>${colorDescription}</p><h3>Ø«ÙŠÙ…Ø§Øª Ø´Ø®ØµÙŠØªÙƒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:</h3><ul>`;
    themes.forEach(theme => html += `<li>${theme}</li>`);
    html += `</ul>`;
    contentDiv.innerHTML = html;
    contentDiv.style.backgroundColor = getColorCode(personalityColor);
}
function getColorCode(colorName) {
    switch (colorName) {
        case "Ø´Ø®ØµÙŠØ© Ø­Ù…Ø±Ø§Ø¡": return "#e74c3c";
        case "Ø´Ø®ØµÙŠØ© Ø²Ø±Ù‚Ø§Ø¡": return "#3498db";
        case "Ø´Ø®ØµÙŠØ© Ø®Ø¶Ø±Ø§Ø¡": return "#2ecc71";
        case "Ø´Ø®ØµÙŠØ© Ø¨Ù†ÙØ³Ø¬ÙŠØ©": return "#9b59b6";
        default: return "#95a5a6";
    }
}
// (Ø£Ø¶Ù Ø¨Ø§Ù‚ÙŠ Ø¯ÙˆØ§Ù„ Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù‡Ù†Ø§)


// --- Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© ---
function downloadPDF() {
    // ... (ÙƒÙˆØ¯ ØªØ­Ù…ÙŠÙ„ PDF ÙŠØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡Ùˆ)
}

function shareResult() {
    // ... (ÙƒÙˆØ¯ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙŠØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡Ùˆ)
}

function logout() {
  localStorage.clear(); // Ù…Ø³Ø­ ÙƒÙ„ Ø´ÙŠØ¡ Ù„Ø¶Ù…Ø§Ù† Ø¬Ù„Ø³Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù†Ø¸ÙŠÙØ©
  location.reload();
}

// --- Ø¯Ø§Ù„Ø© Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ---
window.onload = async () => {
  initDevice();
  initLanguage();
  await loadLanguage(currentLang); // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
  applyTheme(localStorage.getItem("theme") || "light");
};
